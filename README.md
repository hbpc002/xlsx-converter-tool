# XLSX 自动转换工具

一个基于纯 HTML + JavaScript 的 XLSX 文件转换工具，无需任何后端服务，完全在浏览器中运行。

## 📋 功能说明

本工具用于将特定格式的原始表格数据自动转换为工号导入模板格式。

### 🎯 使用场景
- 将包含用户信息的原始表格转换为系统导入格式
- 支持拖拽上传和一键下载
- 本地处理，数据安全不上传服务器

## 🚀 快速开始

### 使用方法

1. **打开工具**
   - 直接在浏览器中打开 `xlsx_converter.html`

2. **上传文件**
   - 拖拽 XLSX 文件到指定区域，或点击选择文件
   - 支持 `.xlsx` 和 `.xls` 格式

3. **自动转换**
   - 系统自动识别字段并转换数据
   - 实时预览转换结果（前10条记录）

4. **下载结果**
   - 点击"下载转换后的文件"按钮
   - 文件名格式：`原文件名_导入模板.xlsx`

## 📊 字段映射关系

### 输入字段 → 输出字段

| 原始表字段 | 导入表字段 | 说明 |
|-----------|-----------|------|
| 所属组织(必填) | 所属部门全路径(必填) | 组织架构信息 |
| 用户帐号(新建不需填写) | 用户帐号(必填) | 用户登录账号 |
| 用户姓名(必填) | 用户姓名(必填) | 用户真实姓名 |
| 证件类型(18位身份证以外需填写) | 证件类型(必填) | 证件类型 |
| 证件号码(必填) | 证件号码(必填) | 证件号码 |
| 手机(必填) | 手机(必填) | 联系电话 |
| 用户类型(联通人员、外包人员、自有、商业紧派遣) | 用户类型(必填) | 人员类型 |
| 岗位性质(客服、市场、渠道、营业厅人员、业务支撑人员、业务处理人员) | 岗位性质(必填) | 岗位分类 |
| 专业部门(客服、市场、渠道、网络数字化、信安、政企) | 专业部门(必填) | 部门分类 |
| 申请角色权限 | 所属角色 | 角色权限 |
| 责任人姓名（必需是自有人员） | 责任人姓名 | 责任人信息 |
| 责任人身份证 | 责任人身份证 | 责任人证件 |
| 责任人电话 | 责任人电话 | 责任人联系方式 |
| 责任人邮箱（必需是中国联通@chinaunicom.cn） | 责任人邮箱 | 责任人邮箱 |

### 输出模板完整字段

转换后的文件包含以下所有字段：

```
所属部门全路径(必填)
用户帐号(必填)
用户姓名(必填)
性别
所属角色
出生日期
证件类型(必填)
证件号码(必填)
手机(必填)
联系人
联系电话
联系地址
邮政编码
内部员工号
用户类型(必填)
密码有效期
教育水平
入职时间
邮箱( 格式要求：email)
用户昵称
签名
地市区域
呼叫中心编码
民族
专业线
级别
最大接待人数
受理地市
受理渠道
外包公司名称
是否离职
离职时间
岗位性质(必填)
随身学账号
所属区域(必填)
专业部门(必填)
责任人ID
责任人姓名
责任人电话
责任人邮箱
责任人身份证
```

## 🔧 技术实现

### 技术栈
- **HTML5** - 页面结构
- **CSS3** - 样式设计
- **JavaScript** - 业务逻辑
- **SheetJS (xlsx.js)** - Excel 文件处理库

### 核心功能

1. **文件读取**
   - 使用 FileReader API 读取本地文件
   - 支持拖拽上传

2. **数据处理**
   - SheetJS 解析 XLSX 文件
   - 自动跳过第一行标题
   - 根据字段映射转换数据

3. **数据导出**
   - SheetJS 生成 XLSX 文件
   - 保留表头格式

### 数据安全
- ✅ 完全本地处理，不上传服务器
- ✅ 不收集任何用户数据
- ✅ 文件处理完成后自动清理

## 📁 项目结构

```
xlsx-converter-tool/
├── xlsx_converter.html    # 主程序文件
└── README.md              # 说明文档
```

## 🎨 界面特性

- **响应式设计** - 适配不同屏幕尺寸
- **拖拽上传** - 友好的用户交互
- **实时预览** - 转换结果即时展示
- **统计信息** - 显示记录数和字段数
- **错误提示** - 友好的错误处理

## 🌐 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 11+
- Edge 79+

## 📝 使用示例

### 输入文件格式

原始表格（跳过第一行标题，从第二行开始）：

| A列（标题） | B列（所属组织） | C列（用户帐号） | D列（用户姓名） | ... |
|------------|----------------|----------------|----------------|-----|
| 标题行 | 所属组织(必填) | 用户帐号(新建不需填写) | 用户姓名(必填) | ... |
| 数据1 | 技术部 | zhangsan | 张三 | ... |
| 数据2 | 市场部 | lisi | 李四 | ... |

### 输出文件格式

转换后的工号导入模板包含所有目标字段，未匹配的字段留空。

## 🐛 常见问题

**Q: 上传后没有反应？**
A: 请检查文件格式是否为 XLSX 或 XLS，确保文件包含有效数据。

**Q: 转换结果为空？**
A: 请确认原始表格的第二行包含正确的字段名称。

**Q: 如何修改字段映射？**
A: 编辑 HTML 文件中的 `fieldMapping` 对象即可自定义映射关系。

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📞 支持

如有问题，请查看控制台错误信息或提交 Issue。

---

**Powered by SheetJS** | **本地处理，安全可靠**
